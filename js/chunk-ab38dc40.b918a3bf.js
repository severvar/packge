(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ab38dc40","chunk-2d0df437","chunk-2d0df437","chunk-2d0df437","chunk-2d0df437","chunk-2d0df437","chunk-2d0df437","chunk-2d0df437","chunk-2d0df437","chunk-2d0df437","chunk-2d0df437","chunk-2d0df437","chunk-2d0df437","chunk-2d0df437","chunk-2d0df437","chunk-2d0df437","chunk-2d225b46"],{4319:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{staticStyle:{top:"5%",height:"100%","overflow-y":"hidden"},attrs:{title:e.title,width:1200,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",wrapClassName:"ant-modal-cust-warp"},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("template",{slot:"footer"},[e.isReadOnly?a("a-button",{key:"back",on:{click:e.handleCancel}},[e._v("\n      关闭\n    ")]):e._e()],1),a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-form",{attrs:{form:e.form}},[a("a-tabs",{attrs:{"default-active-key":"1"}},[a("a-tab-pane",{key:"1",attrs:{tab:"基本信息",forceRender:""}},[a("a-row",{staticClass:"form-row",attrs:{gutter:24}},[a("a-col",{attrs:{lg:8,md:12,sm:24}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["name",e.validatorRules.name],expression:"[ 'name', validatorRules.name]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入名称"}})],1)],1),a("a-col",{attrs:{lg:8,md:12,sm:24}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"规格"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["standard"],expression:"[ 'standard' ]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入规格"}})],1)],1),a("a-col",{attrs:{lg:8,md:12,sm:24}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"单位"}},[a("a-row",{staticClass:"form-row",attrs:{gutter:24}},[a("a-col",{attrs:{lg:13,md:13,sm:24}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["unit"],expression:"[ 'unit' ]",modifiers:{trim:!0}}],attrs:{placeholder:"输入单位",hidden:e.unitStatus}}),a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["unitId"],expression:"[ 'unitId' ]"}],attrs:{value:e.unitList,placeholder:"选择单位",hidden:e.manyUnitStatus,dropdownMatchSelectWidth:!1}},e._l(e.unitList,(function(t,i){return a("a-select-option",{key:i,attrs:{value:t.id}},[e._v("\n                        "+e._s(t.name)+"\n                      ")])})),1)],1),a("a-col",{attrs:{lg:11,md:11,sm:24}},[a("a-checkbox",{attrs:{checked:e.unitChecked},on:{change:e.unitOnChange}},[e._v("多单位")])],1)],1)],1)],1),a("a-col",{attrs:{lg:8,md:12,sm:24}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"型号"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["model"],expression:"[ 'model' ]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入型号"}})],1)],1),a("a-col",{attrs:{lg:8,md:12,sm:24}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"颜色"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["color"],expression:"[ 'color' ]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入颜色"}})],1)],1),a("a-col",{attrs:{lg:8,md:12,sm:24}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"类别"}},[a("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["categoryId"],expression:"[ 'categoryId' ]"}],staticStyle:{width:"100%"},attrs:{dropdownStyle:{maxHeight:"200px",overflow:"auto"},"allow-clear":"",treeData:e.categoryTree,placeholder:"请选择类别"}})],1)],1),a("a-col",{attrs:{lg:8,md:12,sm:24}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"序列号"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["enableSerialNumber"],expression:"[ 'enableSerialNumber' ]"}],attrs:{placeholder:"请选择序列号"}},[a("a-select-option",{attrs:{value:"1"}},[e._v("有")]),a("a-select-option",{attrs:{value:"0"}},[e._v("无")])],1)],1)],1),a("a-col",{attrs:{lg:8,md:12,sm:24}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"安全存量"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["safetyStock"],expression:"[ 'safetyStock' ]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入安全存量"}})],1)],1),a("a-col",{attrs:{lg:8,md:12,sm:24}})],1),a("j-editable-table",{ref:"editableMeTable",attrs:{loading:e.meTable.loading,columns:e.meTable.columns,dataSource:e.meTable.dataSource,maxHeight:300,rowNumber:!0,rowSelection:!0,actionButton:!0}}),a("a-row",{staticClass:"form-row",attrs:{gutter:24}},[a("a-col",{attrs:{lg:24,md:24,sm:24}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:{xs:{span:24},sm:{span:24}},label:""}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark"],expression:"[ 'remark' ]"}],staticStyle:{"margin-top":"8px"},attrs:{rows:2,placeholder:"请输入备注"}})],1)],1)],1)],1),a("a-tab-pane",{key:"2",attrs:{tab:"扩展信息",forceRender:""}},[e.mpShort.mfrs.enabled?a("a-row",{staticClass:"form-row",attrs:{gutter:24}},[a("a-col",{attrs:{lg:8,md:8,sm:8}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:e.mpShort.mfrs.name}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["mfrs"],expression:"[ 'mfrs' ]",modifiers:{trim:!0}}]})],1)],1)],1):e._e(),e.mpShort.otherField1.enabled?a("a-row",{staticClass:"form-row",attrs:{gutter:24}},[a("a-col",{attrs:{lg:8,md:8,sm:8}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:e.mpShort.otherField1.name}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["otherField1"],expression:"[ 'otherField1' ]",modifiers:{trim:!0}}]})],1)],1)],1):e._e(),e.mpShort.otherField2.enabled?a("a-row",{staticClass:"form-row",attrs:{gutter:24}},[a("a-col",{attrs:{lg:8,md:8,sm:8}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:e.mpShort.otherField2.name}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["otherField2"],expression:"[ 'otherField2' ]",modifiers:{trim:!0}}]})],1)],1)],1):e._e(),e.mpShort.otherField3.enabled?a("a-row",{staticClass:"form-row",attrs:{gutter:24}},[a("a-col",{attrs:{lg:8,md:8,sm:8}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:e.mpShort.otherField3.name}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["otherField3"],expression:"[ 'otherField3' ]",modifiers:{trim:!0}}]})],1)],1)],1):e._e()],1),a("a-tab-pane",{key:"3",attrs:{tab:"初始库存",forceRender:""}},[a("j-editable-table",{ref:"editableDepotTable",attrs:{loading:e.depotTable.loading,columns:e.depotTable.columns,dataSource:e.depotTable.dataSource,maxHeight:300,rowNumber:!0,rowSelection:!1,actionButton:!1}})],1),a("a-tab-pane",{key:"4",attrs:{tab:"图片信息",forceRender:""}},[a("a-row",{staticClass:"form-row",attrs:{gutter:24}},[a("a-col",{attrs:{lg:12,md:12,sm:24}},[a("a-form-item",{attrs:{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}},label:"图片信息"}},[a("j-image-upload",{attrs:{bizPath:"material",text:"上传",isMultiple:""},model:{value:e.fileList,callback:function(t){e.fileList=t},expression:"fileList"}})],1)],1),a("a-col",{attrs:{lg:12,md:12,sm:24}})],1)],1)],1)],1)],1)],2)},r=[],l=a("88bc"),n=a.n(l),o=a("7550"),s=a("e2e0"),d=a("4ec3"),c=a("0fea"),u=a("e610"),m=a("2dab"),h=a("2b0e");function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){b(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var g={name:"MaterialModal",components:{JImageUpload:u["default"],JDate:m["default"],JEditableTable:o["default"]},data:function(){return{title:"操作",visible:!1,categoryTree:[],unitList:[],depotList:[],fileList:[],unitStatus:!1,manyUnitStatus:!0,unitChecked:!1,model:{},isReadOnly:!1,labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}},mpShort:{mfrs:{},otherField1:{},otherField2:{},otherField3:{}},meTable:{loading:!1,dataSource:[],columns:[{title:"条码",key:"barCode",width:"30%",type:s["a"].input,defaultValue:"",placeholder:"请输入${title}",validateRules:[{required:!0,message:"${title}不能为空"},{pattern:/^[1-9]\d*$/,message:"请输入零以上的正整数"},{pattern:/^\d{4,13}$/,message:"4到13位数字"},{handler:this.validateBarCode}]},{title:"单位",key:"commodityUnit",width:"12%",type:s["a"].input,defaultValue:"",placeholder:"请输入${title}",validateRules:[{required:!0,message:"${title}不能为空"}]},{title:"采购价",key:"purchaseDecimal",width:"12%",type:s["a"].input,defaultValue:"",placeholder:"请输入${title}"},{title:"零售价",key:"commodityDecimal",width:"12%",type:s["a"].input,defaultValue:"",placeholder:"请输入${title}"},{title:"销售价",key:"wholesaleDecimal",width:"12%",type:s["a"].input,defaultValue:"",placeholder:"请输入${title}"},{title:"最低售价",key:"lowDecimal",width:"12%",type:s["a"].input,defaultValue:"",placeholder:"请输入${title}"}]},depotTable:{loading:!1,dataSource:[],columns:[{title:"仓库",key:"name",width:"15%",type:s["a"].normal},{title:"库存数量",key:"initStock",width:"15%",type:s["a"].input,defaultValue:"",placeholder:"请输入${title}"}]},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{name:{rules:[{required:!0,message:"请输入名称!"},{min:2,max:30,message:"长度在 2 到 30 个字符",trigger:"blur"}]},unit:{rules:[{required:!0,message:"请输入单位!"}]}},url:{add:"/material/add",edit:"/material/update",materialsExtendList:"/materialsExtend/getDetailList",depotWithStock:"/depot/getAllListWithStock"}}},created:function(){this.loadTreeData(),this.loadUnitListData(),this.loadParseMaterialProperty()},methods:{getAllTable:function(){return Promise.all([Object(s["c"])(this,"editableMeTable"),Object(s["c"])(this,"editableDepotTable")])},add:function(){this.getAllTable().then((function(e){e[0].add()})),this.edit({})},edit:function(e){var t=this;if(this.form.resetFields(),this.model=Object.assign({},e),this.activeKey="1",this.visible=!0,"{}"===JSON.stringify(e)?this.fileList=[]:setTimeout((function(){t.fileList=e.imgName}),5),this.$nextTick((function(){t.form.setFieldsValue(n()(t.model,"name","standard","unit","unitId","model","color","categoryId","enableSerialNumber","safetyStock","remark","mfrs","otherField1","otherField2","otherField3"))})),this.model.id){this.model.unit?(this.unitChecked=!1,this.unitStatus=!1,this.manyUnitStatus=!0):(this.unitChecked=!0,this.unitStatus=!0,this.manyUnitStatus=!1);var a={materialId:this.model.id};this.requestMeTableData(this.url.materialsExtendList,a,this.meTable),this.requestDepotTableData(this.url.depotWithStock,{mId:this.model.id},this.depotTable)}else this.requestDepotTableData(this.url.depotWithStock,{mId:0},this.depotTable)},requestMeTableData:function(e,t,a){a.loading=!0,Object(c["c"])(e,t).then((function(e){a.dataSource=e.data.rows||[]})).finally((function(){a.loading=!1}))},requestDepotTableData:function(e,t,a){a.loading=!0,Object(c["c"])(e,t).then((function(e){a.dataSource=e.data||[]})).finally((function(){a.loading=!1}))},close:function(){this.$emit("close"),this.visible=!1,this.unitStatus=!1,this.manyUnitStatus=!0,this.unitChecked=!1,this.getAllTable().then((function(e){e[0].initialize(),e[1].initialize()}))},handleOk:function(){this.validateFields()},handleCancel:function(){this.close()},validateFields:function(){var e=this;this.getAllTable().then((function(t){return Object(s["d"])(e.form,t)})).then((function(t){var a=e.classifyIntoFormData(t);return a.sortList=[],void 0===a.unit&&(a.unit=""),void 0===a.unitId&&(a.unitId=""),e.unitChecked?a.unit="":a.unitId="",e.requestAddOrEdit(a)})).catch((function(t){t.error===s["b"]&&(e.activeKey=null==t.index?e.activeKey:(t.index+1).toString())}))},classifyIntoFormData:function(e){var t=Object.assign(this.model,e.formValue);return f(f({},t),{},{meList:e.tablesValue[0].values,stock:e.tablesValue[1].values})},requestAddOrEdit:function(e){var t=this;if(""!==e.unit||""!==e.unitId)if(0!==e.meList.length){var a={id:this.model.id?this.model.id:0,name:this.model.name,model:this.parseParam(this.model.model),color:this.parseParam(this.model.color),standard:this.parseParam(this.model.standard),mfrs:this.parseParam(this.model.mfrs),otherField1:this.parseParam(this.model.otherField1),otherField2:this.parseParam(this.model.otherField2),otherField3:this.parseParam(this.model.otherField3),unit:this.parseParam(this.model.unit),unitId:this.parseParam(this.model.unitId)};Object(d["t"])(a).then((function(a){if(a&&200===a.code){if(a.data.status)return void t.$message.warning("抱歉，该商品已存在！");var i="";if(e.unitId)for(var r=0;r<t.unitList.length;r++)t.unitList[r].id==e.unitId&&(i=t.unitList[r].name);var l=i.substring(0,i.indexOf("(")),n=l.split(",");if(!e.unit){if(e.meList.length<2)return void t.$message.warning("多单位的商品条码行数至少要有两行，请再新增一行条码信息！");if(e.meList[0].commodityUnit!=n[0])return void t.$message.warning("条码之后的单位填写有误，单位【"+e.meList[0].commodityUnit+"】请修改为【"+n[0]+"】！");if(e.meList[1].commodityUnit!=n[1])return void t.$message.warning("条码之后的单位填写有误，单位【"+e.meList[1].commodityUnit+"】请修改为【"+n[1]+"】！")}for(var o=0;o<e.meList.length;o++){var s=e.meList[o].commodityUnit;if(e.unit){if(s!=e.unit)return void t.$message.warning("条码之后的单位填写有误，单位【"+s+"】请修改为【"+e.unit+"】！")}else if(i&&s!=n[0]&&s!=n[1])return void t.$message.warning("条码之后的单位填写有误，单位【"+s+"】请修改为【"+n[0]+"】或【"+n[1]+"】！")}t.fileList&&t.fileList.length>0?e.imgName=t.fileList:e.imgName="";var d=t.url.add,u="post";t.model.id&&(d=t.url.edit,u="put");var m=t;t.confirmLoading=!0,Object(c["e"])(d,e,u).then((function(e){200===e.code?(m.$emit("ok"),m.confirmLoading=!1,m.close()):(m.$message.warning(e.data.message),m.confirmLoading=!1)})).finally((function(){}))}}))}else this.$message.warning("抱歉，请输入条码信息！");else this.$message.warning("抱歉，单位为必填项！")},parseParam:function(e){return e||""},validateBarCode:function(e,t,a,i,r,l){var n={barCode:t,id:20==a.id.length?0:a.id};Object(d["u"])(n).then((function(e){e&&200===e.code?e.data.status?r(!1,"该条码已经存在"):r(!0):r(!1,e.data)}))},loadTreeData:function(){var e=this,t={id:""};Object(d["ob"])(t).then((function(t){if(t){e.categoryTree=[];for(var a=0;a<t.length;a++){var i=t[a];e.categoryTree.push(i)}}}))},loadUnitListData:function(){var e=this,t={currentPage:1,pageSize:100};Object(c["c"])("/unit/list",t).then((function(t){t&&(e.unitList=t.data.rows)}))},loadParseMaterialProperty:function(){for(var e=h["a"].ls.get("materialPropertyList"),t=0;t<e.length;t++)"制造商"===e[t].nativeName&&(this.mpShort.mfrs.name=e[t].anotherName,this.mpShort.mfrs.enabled=e[t].enabled),"自定义1"===e[t].nativeName&&(this.mpShort.otherField1.name=e[t].anotherName,this.mpShort.otherField1.enabled=e[t].enabled),"自定义2"===e[t].nativeName&&(this.mpShort.otherField2.name=e[t].anotherName,this.mpShort.otherField2.enabled=e[t].enabled),"自定义3"===e[t].nativeName&&(this.mpShort.otherField3.name=e[t].anotherName,this.mpShort.otherField3.enabled=e[t].enabled)},unitOnChange:function(e){var t=e.target.checked;t?(this.unitStatus=!0,this.manyUnitStatus=!1,this.unitChecked=!0):(this.unitStatus=!1,this.manyUnitStatus=!0,this.unitChecked=!1)}}},v=g,w=a("2877"),y=Object(w["a"])(v,i,r,!1,null,"04a6fba3",null);t["default"]=y.exports},"88bc":function(e,t,a){(function(t){var a=1/0,i=9007199254740991,r="[object Arguments]",l="[object Function]",n="[object GeneratorFunction]",o="[object Symbol]",s="object"==typeof t&&t&&t.Object===Object&&t,d="object"==typeof self&&self&&self.Object===Object&&self,c=s||d||Function("return this")();function u(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}function m(e,t){var a=-1,i=e?e.length:0,r=Array(i);while(++a<i)r[a]=t(e[a],a,e);return r}function h(e,t){var a=-1,i=t.length,r=e.length;while(++a<i)e[r+a]=t[a];return e}var p=Object.prototype,f=p.hasOwnProperty,b=p.toString,g=c.Symbol,v=p.propertyIsEnumerable,w=g?g.isConcatSpreadable:void 0,y=Math.max;function C(e,t,a,i,r){var l=-1,n=e.length;a||(a=O),r||(r=[]);while(++l<n){var o=e[l];t>0&&a(o)?t>1?C(o,t-1,a,i,r):h(r,o):i||(r[r.length]=o)}return r}function S(e,t){return e=Object(e),k(e,t,(function(t,a){return a in e}))}function k(e,t,a){var i=-1,r=t.length,l={};while(++i<r){var n=t[i],o=e[n];a(o,n)&&(l[n]=o)}return l}function L(e,t){return t=y(void 0===t?e.length-1:t,0),function(){var a=arguments,i=-1,r=y(a.length-t,0),l=Array(r);while(++i<r)l[i]=a[t+i];i=-1;var n=Array(t+1);while(++i<t)n[i]=a[i];return n[t]=l,u(e,this,n)}}function O(e){return F(e)||j(e)||!!(w&&e&&e[w])}function x(e){if("string"==typeof e||I(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}function j(e){return P(e)&&f.call(e,"callee")&&(!v.call(e,"callee")||b.call(e)==r)}var F=Array.isArray;function T(e){return null!=e&&U(e.length)&&!N(e)}function P(e){return D(e)&&T(e)}function N(e){var t=$(e)?b.call(e):"";return t==l||t==n}function U(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=i}function $(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function D(e){return!!e&&"object"==typeof e}function I(e){return"symbol"==typeof e||D(e)&&b.call(e)==o}var A=L((function(e,t){return null==e?{}:S(e,m(C(t,1),x))}));e.exports=A}).call(this,a("24aa"))},e610:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-upload",{attrs:{name:"file",listType:"picture-card",multiple:e.isMultiple,action:e.uploadAction,headers:e.headers,data:{biz:e.bizPath},fileList:e.fileList,beforeUpload:e.beforeUpload,disabled:e.disabled,isMultiple:e.isMultiple,showUploadList:e.isMultiple},on:{change:e.handleChange,preview:e.handlePreview}},[!e.isMultiple&&e.picUrl?a("img",{staticStyle:{height:"104px","max-width":"300px"},attrs:{src:e.getAvatarView()}}):a("div",[a("a-icon",{attrs:{type:e.uploadLoading?"loading":"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v(e._s(e.text))])],1),a("a-modal",{attrs:{visible:e.previewVisible,footer:null},on:{cancel:function(t){return e.handleCancel()}}},[a("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})])],1)},r=[],l=a("2b0e"),n=a("9fb0"),o=a("0fea"),s=a("4ec3"),d=function(){return"-"+parseInt(1e4*Math.random()+1,10)},c=function(e){if(e.lastIndexOf("\\")>=0){var t=new RegExp("\\\\","g");e=e.replace(t,"/")}return e.substring(e.lastIndexOf("/")+1)},u={name:"JImageUpload",data:function(){return{uploadAction:window._CONFIG["domianURL"]+"/systemConfig/upload",uploadLoading:!1,picUrl:!1,headers:{},fileList:[],previewImage:"",previewVisible:!1,sizeLimit:0,uploadGoOn:!0}},props:{text:{type:String,required:!1,default:"上传"},bizPath:{type:String,required:!1,default:"temp"},value:{type:[String,Array],required:!1},disabled:{type:Boolean,required:!1,default:!1},isMultiple:{type:Boolean,required:!1,default:!1}},watch:{value:function(e){e instanceof Array?this.initFileList(e.join(",")):this.initFileList(e)}},created:function(){this.initFileSizeLimit();var e=l["a"].ls.get(n["a"]);this.headers={"X-Access-Token":e}},methods:{initFileSizeLimit:function(){var e=this;Object(s["U"])().then((function(t){200===t.code&&(e.sizeLimit=t.data)}))},initFileList:function(e){if(!e||0==e.length)return this.fileList=[],void(this.picUrl=!1);this.picUrl=!0;for(var t=[],a=e.split(","),i=0;i<a.length;i++){var r=Object(o["d"])("systemConfig/static/"+a[i]);t.push({uid:d(),name:c(a[i]),status:"done",url:r,response:{code:"history",data:a[i]}})}this.fileList=t},beforeUpload:function(e){this.uploadGoOn=!0;var t=e.type,a=e.size;if(t.indexOf("image")<0)return this.$message.warning("请上传图片"),this.uploadGoOn=!1,!1;if(a>this.sizeLimit){var i=(this.sizeLimit/1024/1024).toFixed(2);return this.$message.warning("抱歉，图片大小不能超过"+i+"M"),this.uploadGoOn=!1,!1}return!0},handleChange:function(e){e.file.status||!1!==this.uploadGoOn||e.fileList.pop(),this.picUrl=!1;var t=e.fileList;"done"===e.file.status?200===e.file.response.code&&(this.picUrl=!0,t=t.map((function(e){return e.response&&(e.url=e.response.data),e}))):"error"===e.file.status?this.$message.error("".concat(e.file.name," 上传失败.")):"removed"===e.file.status&&this.handleDelete(e.file),this.fileList=t,"done"!==e.file.status&&"removed"!==e.file.status||this.handlePathChange()},handlePreview:function(e){this.previewImage=e.url||e.thumbUrl,this.previewVisible=!0},getAvatarView:function(){if(this.fileList.length>0){var e=this.fileList[0].url;return e}},handlePathChange:function(){var e=this.fileList,t="";e&&0!=e.length||(t="");var a=[];if(this.isMultiple)for(var i=0;i<e.length;i++)a.push(e[i].response.data);else a.push(e[e.length-1].response.data);a.length>0&&(t=a.join(",")),this.$emit("change",t)},handleDelete:function(e){},handleCancel:function(){this.close(),this.previewVisible=!1},close:function(){}},model:{prop:"value",event:"change"}},m=u,h=a("2877"),p=Object(h["a"])(m,i,r,!1,null,"2b496df3",null);t["default"]=p.exports}}]);