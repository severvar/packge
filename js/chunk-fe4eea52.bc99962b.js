(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fe4eea52","chunk-2d0bdf09","chunk-2d228e42"],{"18a4":function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-modal",{staticStyle:{top:"15%",height:"70%","overflow-y":"hidden"},attrs:{title:e.title,width:800,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",wrapClassName:"ant-modal-cust-warp"},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("template",{slot:"footer"},[e.isReadOnly?t("a-button",{key:"back",on:{click:e.handleCancel}},[e._v("\n      关闭\n    ")]):e._e()],1),t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"序列号"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["serialNumber",e.validatorRules.serialNumber],expression:"[ 'serialNumber', validatorRules.serialNumber]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入序列号"}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"商品条码"}},[t("j-select-serial-material",{directives:[{name:"decorator",rawName:"v-decorator",value:["materialCode",e.validatorRules.materialCode],expression:"[ 'materialCode', validatorRules.materialCode]"}],attrs:{multi:!1},on:{change:e.onInputChange}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"商品名称"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["materialName"],expression:"[ 'materialName' ]"}],attrs:{readOnly:!0}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"备注"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark"],expression:"[ 'remark' ]"}],attrs:{rows:2,placeholder:"请输入备注"}})],1)],1)],1)],2)},l=[],i=t("88bc"),n=t.n(i),o=t("dab1"),s=t("4ec3"),d=t("ca00"),m=t("2b0e"),c={name:"SerialNumberModal",components:{JSelectSerialMaterial:o["default"]},data:function(){return{title:"操作",visible:!1,model:{},isReadOnly:!1,labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{serialNumber:{rules:[{required:!0,message:"请输入序列号!"},{min:2,max:30,message:"长度在 2 到 30 个字符",trigger:"blur"},{validator:this.validateSerialNumberName}]},materialCode:{rules:[{required:!0,message:"请选择商品条码!"}]}}}},created:function(){},methods:{add:function(){this.edit({})},edit:function(e){var a=this;this.form.resetFields(),this.model=Object.assign({},e),this.visible=!0,this.$nextTick((function(){a.form.setFieldsValue(n()(a.model,"serialNumber","materialCode","materialName","remark"))}))},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){var e=this,a=this;this.form.validateFields((function(t,r){if(!t){a.confirmLoading=!0;var l,i=Object.assign(e.model,r);l=e.model.id?Object(s["N"])(i):Object(s["g"])(i),l.then((function(e){200===e.code?a.$emit("ok"):a.$message.warning(e.data.message)})).finally((function(){a.confirmLoading=!1,a.close()}))}}))},handleCancel:function(){this.close()},validateSerialNumberName:function(e,a,t){var r={name:a,id:this.model.id?this.model.id:0};Object(s["z"])(r).then((function(e){e&&200===e.code?e.data.status?t("序列号已经存在"):t():t(e.data)}))},onInputChange:function(e){var a=this,t={barCode:e,mpList:Object(d["f"])(m["a"].ls.get("materialPropertyList"))};Object(s["gb"])(t).then((function(e){e&&200===e.code&&a.form.setFieldsValue({materialName:e.data.name})}))}}},u=c,f=t("2877"),p=Object(f["a"])(u,r,l,!1,null,"7ec683a1",null);a["default"]=p.exports},"1d9d":function(e,a,t){"use strict";t("fc18")},"29a1":function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-modal",{staticStyle:{top:"10%",height:"80%","overflow-y":"hidden"},attrs:{title:e.title,width:800,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",wrapClassName:"ant-modal-cust-warp"},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"序列号前缀"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["serialNumberPrefix",e.validatorRules.serialNumberPrefix],expression:"[ 'serialNumberPrefix', validatorRules.serialNumberPrefix]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入序列号前缀"}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"序列号数量"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["batAddTotal",e.validatorRules.batAddTotal],expression:"[ 'batAddTotal', validatorRules.batAddTotal]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入序列号数量"}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"商品条码"}},[t("j-select-serial-material",{directives:[{name:"decorator",rawName:"v-decorator",value:["materialCode",e.validatorRules.materialCode],expression:"[ 'materialCode', validatorRules.materialCode]"}],attrs:{multi:!1},on:{change:e.onInputChange}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"商品名称"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["materialName"],expression:"[ 'materialName' ]"}],attrs:{readOnly:!0}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"备注"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark"],expression:"[ 'remark' ]"}],attrs:{rows:2,placeholder:"请输入备注"}})],1)],1)],1)],1)},l=[],i=t("88bc"),n=t.n(i),o=t("dab1"),s=t("4ec3"),d=t("ca00"),m=t("2b0e"),c={name:"SerialNumberBatchModal",components:{JSelectSerialMaterial:o["default"]},data:function(){return{title:"操作",visible:!1,model:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{serialNumberPrefix:{rules:[{required:!0,message:"请输入序列号前缀!"},{min:2,max:30,message:"长度在 2 到 30 个字符",trigger:"blur"}]},batAddTotal:{rules:[{required:!0,message:"请输入序列号数量!"}]},materialCode:{rules:[{required:!0,message:"请选择商品条码!"}]}}}},created:function(){},methods:{add:function(){this.edit({})},edit:function(e){var a=this;this.form.resetFields(),this.model=Object.assign({},e),this.visible=!0,this.$nextTick((function(){a.form.setFieldsValue(n()(a.model,"serialNumberPrefix","batAddTotal","materialCode","materialName","remark"))}))},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){var e=this,a=this;this.form.validateFields((function(t,r){if(!t){a.confirmLoading=!0;var l,i=Object.assign(e.model,r);e.model.id||(l=Object(s["m"])(i)),l.then((function(e){200===e.code?a.$emit("ok"):a.$message.warning(e.data.message)})).finally((function(){a.confirmLoading=!1,a.close()}))}}))},handleCancel:function(){this.close()},onInputChange:function(e){var a=this,t={barCode:e,mpList:Object(d["f"])(m["a"].ls.get("materialPropertyList"))};Object(s["gb"])(t).then((function(e){e&&200===e.code&&a.form.setFieldsValue({materialName:e.data.name})}))}}},u=c,f=t("2877"),p=Object(f["a"])(u,r,l,!1,null,"55b788d4",null);a["default"]=p.exports},"2dab":function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-date-picker",{attrs:{disabled:e.disabled||e.readOnly,placeholder:e.placeholder,value:e.momVal,showTime:e.showTime,format:e.dateFormat,getCalendarContainer:e.getCalendarContainer},on:{change:e.handleDateChange}})},l=[],i=t("c1df"),n=t.n(i),o={name:"JDate",props:{placeholder:{type:String,default:"",required:!1},value:{type:String,required:!1},dateFormat:{type:String,default:"YYYY-MM-DD HH:mm:ss",required:!1},triggerChange:{type:Boolean,required:!1,default:!1},readOnly:{type:Boolean,required:!1,default:!1},disabled:{type:Boolean,required:!1,default:!1},showTime:{type:Boolean,required:!1,default:!1},getCalendarContainer:{type:Function,default:function(e){return e.parentNode}}},data:function(){var e=this.value;return{decorator:"",momVal:e?n()(e,this.dateFormat):null}},watch:{value:function(e){this.momVal=e?n()(e,this.dateFormat):null}},methods:{moment:n.a,handleDateChange:function(e,a){this.$emit("change",a)}},model:{prop:"value",event:"change"}},s=o,d=t("2877"),m=Object(d["a"])(s,r,l,!1,null,null,null);a["default"]=m.exports},"4e28":function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:24}},[t("a-card",{attrs:{bordered:!1}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.searchQuery.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:6,sm:8}},[t("a-form-item",{attrs:{label:"序列号",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[t("a-input",{attrs:{placeholder:"请输入序列号查询"},model:{value:e.queryParam.serialNumber,callback:function(a){e.$set(e.queryParam,"serialNumber",a)},expression:"queryParam.serialNumber"}})],1)],1),t("a-col",{attrs:{md:6,sm:8}},[t("a-form-item",{attrs:{label:"商品名称",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[t("a-input",{attrs:{placeholder:"请输入商品名称查询"},model:{value:e.queryParam.materialName,callback:function(a){e.$set(e.queryParam,"materialName",a)},expression:"queryParam.materialName"}})],1)],1),t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-col",{attrs:{md:6,sm:24}},[t("a-button",{attrs:{type:"primary"},on:{click:e.searchQuery}},[e._v("查询")]),t("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.searchReset}},[e._v("重置")])],1)],1)],1)],1)],1),t("div",{staticClass:"table-operator",staticStyle:{"margin-top":"5px"}},[e.btnEnableList.indexOf(1)>-1?t("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("新增")]):e._e(),e.btnEnableList.indexOf(1)>-1?t("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleBatchAdd}},[e._v("批量新增")]):e._e(),e.selectedRowKeys.length>0?t("a-dropdown",[t("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[e.btnEnableList.indexOf(1)>-1?t("a-menu-item",{key:"1",on:{click:e.batchDel}},[t("a-icon",{attrs:{type:"delete"}}),e._v("删除")],1):e._e()],1),t("a-button",{staticStyle:{"margin-left":"8px"}},[e._v("\n            批量操作 "),t("a-icon",{attrs:{type:"down"}})],1)],1):e._e()],1),t("div",[t("a-table",{ref:"table",attrs:{size:"middle",bordered:"",rowKey:"id",columns:e.columns,dataSource:e.dataSource,pagination:e.ipagination,loading:e.loading,rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange}},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"action",fn:function(a,r){return t("span",{},[t("a",{on:{click:function(a){return e.handleEdit(r)}}},[e._v("编辑")]),e.btnEnableList.indexOf(1)>-1?t("a-divider",{attrs:{type:"vertical"}}):e._e(),e.btnEnableList.indexOf(1)>-1?t("a-popconfirm",{attrs:{title:"确定删除吗?"},on:{confirm:function(){return e.handleDelete(r.id)}}},[t("a",[e._v("删除")])]):e._e()],1)}},{key:"numberCustomRender",fn:function(a,r){return t("span",{},[t("a",{on:{click:function(a){return e.myHandleDetail(r)}}},[e._v(e._s(r.depotHeadNumber))])])}},{key:"customRenderFlag",fn:function(a){return[1==a?t("a-tag",{attrs:{color:"green"}},[e._v("是")]):e._e(),0==a?t("a-tag",{attrs:{color:"orange"}},[e._v("否")]):e._e()]}},{key:"customRenderTime",fn:function(a){return[e._v("\n            "+e._s(e.simpleDateFormat(a,"yyyy-MM-dd hh:mm:ss"))+"\n          ")]}}])})],1),t("serial-number-modal",{ref:"modalForm",on:{ok:e.modalFormOk}}),t("serial-number-batch-modal",{ref:"serialNumberBatchModel",on:{ok:e.modalFormOk}}),t("bill-detail",{ref:"modalDetail"})],1)],1)],1)},l=[],i=t("18a4"),n=t("29a1"),o=t("9be9"),s=t("b65a"),d=t("ca00"),m=t("4ec3"),c=t("2dab"),u={name:"SerialNumberList",mixins:[s["a"]],components:{SerialNumberModal:i["default"],SerialNumberBatchModal:n["default"],BillDetail:o["default"],JDate:c["default"]},data:function(){return{queryParam:{materialName:"",serialNumber:""},columns:[{title:"#",dataIndex:"",key:"rowIndex",width:40,align:"center",customRender:function(e,a,t){return parseInt(t)+1}},{title:"序列号",align:"left",dataIndex:"serialNumber",width:180},{title:"商品条码",align:"center",dataIndex:"materialCode",width:120},{title:"商品名称",align:"center",dataIndex:"materialName",width:120},{title:"单据编号",align:"center",dataIndex:"depotHeadNumber",width:150,scopedSlots:{customRender:"numberCustomRender"}},{title:"已卖出",align:"center",dataIndex:"isSell",width:60,scopedSlots:{customRender:"customRenderFlag"}},{title:"创建时间",align:"center",dataIndex:"createTime",width:180,scopedSlots:{customRender:"customRenderTime"}},{title:"更新时间",align:"center",dataIndex:"updateTime",width:180,scopedSlots:{customRender:"customRenderTime"}},{title:"操作",dataIndex:"action",width:200,align:"center",scopedSlots:{customRender:"action"}}],url:{list:"/serialNumber/list",delete:"/serialNumber/delete",deleteBatch:"/serialNumber/deleteBatch"}}},computed:{},methods:{handleBatchAdd:function(){this.$refs.serialNumberBatchModel.add(),this.$refs.serialNumberBatchModel.title="批量新增",this.$refs.serialNumberBatchModel.disableSubmit=!1},simpleDateFormat:function(e,a){return Object(d["d"])(e,a)},handleEdit:function(e){this.$refs.modalForm.edit(e),this.$refs.modalForm.title="编辑",this.$refs.modalForm.disableSubmit=!1,-1===this.btnEnableList.indexOf(1)&&(this.$refs.modalForm.isReadOnly=!0)},myHandleDetail:function(e){var a=this;Object(m["V"])({number:e.depotHeadNumber}).then((function(t){t&&200===t.code&&a.handleDetail(t.data,e.depotHeadType)}))}}},f=u,p=(t("1d9d"),t("2877")),b=Object(p["a"])(f,r,l,!1,null,"4d625728",null);a["default"]=b.exports},dab1:function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("a-input-search",{attrs:{placeholder:"请选择序列号商品",readOnly:""},on:{search:e.onSearchMaterial},model:{value:e.materialNames,callback:function(a){e.materialNames=a},expression:"materialNames"}}),t("j-select-serial-material-modal",{ref:"selectModal",attrs:{"modal-width":e.modalWidth,multi:e.multi,"bar-code":e.value},on:{ok:e.selectOK,initComp:e.initComp}})],1)},l=[],i=t("b0b6");function n(e,a){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=o(e))||a&&e&&"number"===typeof e.length){t&&(e=t);var r=0,l=function(){};return{s:l,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,n=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return n=e.done,e},e:function(e){s=!0,i=e},f:function(){try{n||null==t.return||t.return()}finally{if(s)throw i}}}}function o(e,a){if(e){if("string"===typeof e)return s(e,a);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?s(e,a):void 0}}function s(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,r=new Array(a);t<a;t++)r[t]=e[t];return r}var d={name:"JSelectSerialMaterial",components:{JSelectSerialMaterialModal:i["default"]},props:{modalWidth:{type:Number,default:1100,required:!1},value:{type:String,required:!1},disabled:{type:Boolean,required:!1,default:!1},multi:{type:Boolean,default:!0,required:!1}},data:function(){return{materialIds:"",materialNames:""}},mounted:function(){this.materialIds=this.value},watch:{value:function(e){this.materialIds=e}},model:{prop:"value",event:"change"},methods:{initComp:function(e){this.materialNames=e},onSearchMaterial:function(){this.$refs.selectModal.showModal()},selectOK:function(e,a){if(e){var t,r="",l=n(e);try{for(l.s();!(t=l.n()).done;){var i=t.value;r+=","+i.mBarCode}}catch(o){l.e(o)}finally{l.f()}this.materialNames=r.substring(1),this.materialIds=a}else this.materialNames="",this.materialIds="";this.$emit("change",this.materialIds)}}},m=d,c=t("2877"),u=Object(c["a"])(m,r,l,!1,null,"bab21d48",null);a["default"]=u.exports},fc18:function(e,a,t){}}]);