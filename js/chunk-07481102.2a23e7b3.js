(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07481102"],{"267bb":function(t,n,e){"use strict";e.r(n),e.d(n,"FinancialModalMixin",(function(){return s}));e("e2e0");var o=e("4ec3"),i=e("0fea"),a=e("ca00");function r(t,n){var e="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=u(t))||n&&t&&"number"===typeof t.length){e&&(t=e);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,c=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return r=t.done,t},e:function(t){c=!0,a=t},f:function(){try{r||null==e.return||e.return()}finally{if(c)throw a}}}}function u(t,n){if(t){if("string"===typeof t)return c(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?c(t,n):void 0}}function c(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=new Array(n);e<n;e++)o[e]=t[e];return o}var s={data:function(){return{action:"",supList:[],cusList:[],retailList:[],personList:[],accountList:[],spans:{labelCol1:{span:2},wrapperCol1:{span:22},labelCol1_5:{span:3},wrapperCol1_5:{span:21},labelCol2:{span:4},wrapperCol2:{span:20},labelCol3:{span:6},wrapperCol3:{span:18},labelCol6:{span:12},wrapperCol6:{span:12}}}},created:function(){this.initSupplier(),this.initCustomer(),this.initRetail(),this.initPerson()},computed:{readOnly:function(){return"add"!==this.action&&"edit"!==this.action}},methods:{addInit:function(t){var n=this;Object(i["c"])("/sequence/buildNumber").then((function(e){e&&200===e.code&&n.form.setFieldsValue({billNo:t+e.data.defaultNumber})})),this.$nextTick((function(){n.form.setFieldsValue({billTime:Object(a["g"])(),totalPrice:0,discountMoney:0,changeAmount:0})})),this.$nextTick((function(){Object(o["db"])({}).then((function(t){if(t&&200===t.code){var e,o=r(t.data.accountList);try{for(o.s();!(e=o.n()).done;){var i=e.value;i.isDefault&&n.form.setFieldsValue({accountId:i.id})}}catch(a){o.e(a)}finally{o.f()}}}))}))},initSupplier:function(){var t=this;Object(o["Y"])({}).then((function(n){n&&(t.supList=n)}))},initCustomer:function(){var t=this;Object(o["W"])({}).then((function(n){n&&(t.cusList=n)}))},initRetail:function(){var t=this;Object(o["X"])({}).then((function(n){n&&(t.retailList=n)}))},initPerson:function(){var t=this;Object(o["jb"])({type:"财务员"}).then((function(n){n&&200===n.code&&(t.personList=n.data.personList)}))},initInOutItem:function(t){var n=this;Object(o["ab"])({type:t}).then((function(t){if(t)for(var e=0;e<t.length;e++){var o={};o.value=t[e].id+"",o.text=t[e].name,o.title=t[e].name;var i,a=r(n.accountTable.columns);try{for(a.s();!(i=a.n()).done;){var u=i.value;"inOutItemId"==u.key&&u.options.push(o)}}catch(c){a.e(c)}finally{a.f()}}}))},initAccount:function(){var t=this;Object(o["db"])({}).then((function(n){n&&200===n.code&&(t.accountList=n.data.accountList)}))},initDetailAccount:function(){var t=this;Object(o["db"])({}).then((function(n){if(n&&200===n.code)for(var e=n.data.accountList,o=0;o<e.length;o++){var i={};i.value=e[o].id+"",i.text=e[o].name,i.title=e[o].name;var a,u=r(t.accountTable.columns);try{for(u.s();!(a=u.n()).done;){var c=a.value;"accountId"==c.key&&c.options.push(i)}}catch(s){u.e(s)}finally{u.f()}}}))},onValueChange:function(t){var n=this,e=(t.type,t.row,t.column),o=(t.value,t.target);switch(e.key){case"eachAmount":o.recalcAllStatisticsColumns(),n.autoChangeAmount(o);break}},autoChangeAmount:function(t){var n=this,e=t.statisticsColumns.eachAmount-0,o=this.form.getFieldValue("discountMoney")-0;o||(o=0);var i=(e-o).toFixed(2);this.$nextTick((function(){n.form.setFieldsValue({totalPrice:e,changeAmount:i})}))},onKeyUpDiscountMoney:function(t){var n=this,e=t.target.value-0,o=this.form.getFieldValue("totalPrice")-0,i=(o-e).toFixed(2);this.$nextTick((function(){n.form.setFieldsValue({changeAmount:i})}))},debtBillListOk:function(t){t&&t.length>0&&this.requestSubTableDataEx(t,this.accountTable)},requestSubTableDataEx:function(t,n,e){var o=this;n.loading=!0;for(var i=[],a=0,r=0;r<t.length;r++){var u=t[r];u.billNumber=u.number,u.needDebt=(u.discountLastMoney+u.otherMoney-u.changeAmount).toFixed(2),u.eachAmount=(u.discountLastMoney+u.otherMoney-u.changeAmount-u.finishDebt).toFixed(2),0!=u.eachAmount&&(a+=u.eachAmount-0,i.push(u))}n.dataSource=i,this.$nextTick((function(){o.form.setFieldsValue({totalPrice:a,changeAmount:a})})),"function"===typeof e&&e(res),n.loading=!1}}}},e2e0:function(t,n,e){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}e.d(n,"a",(function(){return i})),e.d(n,"b",(function(){return a})),e.d(n,"c",(function(){return r})),e.d(n,"d",(function(){return u}));var i={normal:"normal",input:"input",inputNumber:"inputNumber",checkbox:"checkbox",select:"select",date:"date",datetime:"datetime",upload:"upload",file:"file",image:"image",popup:"popup",popupJsh:"popupJsh",list_multi:"list_multi",sel_search:"sel_search",radio:"radio",checkbox_meta:"checkbox_meta",input_pop:"input_pop",slot:"slot",hidden:"hidden"},a=Symbol();function r(t,n){return new Promise((function(e){(function o(){var i=t.$refs[n];i?e(i):setTimeout((function(){o()}),10)})()}))}function u(t,n){if(!t||"function"!==typeof t.validateFields)throw"form 参数需要的是一个form对象，而传入的却是".concat(o(t));var e={};return new Promise((function(n,e){t.validateFields((function(t,o){t?e({error:a}):n(o)}))})).then((function(t){return Object.assign(e,{formValue:t}),c(n)})).then((function(t){return Object.assign(e,{tablesValue:t}),Promise.resolve(e)})).catch((function(t){return Promise.reject(t)}))}function c(t,n){if(!(t instanceof Array))throw"'validateTables'函数的'cases'参数需要的是一个数组，而传入的却是".concat(o(t));return new Promise((function(e,o){var i=[],r=0;t&&0!=t.length||e(),function u(){var c=t[r];c.getAll(!0,n).then((function(n){i[r]=n,++r===t.length?e(i):u()}),(function(t){t===a&&o({error:a,index:r}),o(t)}))}()}))}}}]);